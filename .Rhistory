a
library(stringr)
str_split(a,'^A')
as.character(a)
class(a)
a
a <- paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir=') %>%
getURL
a
class(a)
str_split(a,'^A')
b <- str_split(a,'^A')
class(b)
length(b)
?str_split
str_split(a,'^A')
str_split(a,'A')
?str_split
strsplit(a,'^A')
kegg_map
class(kegg_map)
strsplit(kegg_map,'^A')
a <- paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir=') %>%
getURL
A
a
strsplit(kegg_map,'\nA')
strsplit(a,'\nA')
strsplit(a,'\nA')
b <- strsplit(a,'\nA')
length(b)
b[[1]]
length(b[[1]])
b[[1]][1]
b[[1]][8]
b <- strsplit(a,'\nA') %>%
unlist %>%
strsplit('\nB')
b
length(b)
b[[1]]
b[[2]]
length(b[[2]])
b[[2]][[1]]
b[[2]][[2]]
kegg_map
class(kegg_map)
as.character(kegg_map)
showMethods(class=class(kegg_map), where=search())
as(kegg_map,"character")
kegg_map
html_nodes(kegg_map,'b')
html_text(kegg_map,'b')
map_class <- html_nodes(kegg_map,'b')
map_class
a <- html_text(map_class,'b')
a
a
a <- html_text(kegg_map,'b')
a
length(a)
class(a)
help(package='rvest')
map_class <- html_nodes(kegg_map,'b')
map_class
a <- html_text(kegg_map,'b')
a
a <- html_text(map_class,'b')
a
html_text(kegg_map,'b')
a <- html_text(kegg_map,'b')
class(a)
length(a)
map_class <- html_nodes(kegg_map,'b') %>%
html_text('b')
map_class
as(kegg_map,'character')
a <- as(kegg_map,'character')
a
class(a)
help(package='stringr')
str_extract_all(a,paste0(map_class[1],'*',map_class[2]))
paste0(map_class[1],'*',map_class[2])
paste0(map_class[1],'*.',map_class[2])
str_extract_all(a,paste0(map_class[1],'*.',map_class[2]))
str_extract_all(a,"Metabolism*.Genetic Information Processing")
a
str_extract_all(a,"Metabolism.*Genetic Information Processing")
?for''
?for
'?for'
`?for`
?for
"?for"
`?for`
?`for`
str_extract_all(a,paste0(map_class[1],'*',map_class[2]))
length(map_class)
map_class
html_nodes(kegg_map,'b') %>%
html_text('b')
html_nodes(kegg_map,'br') %>%
html_text('br')
map_class <- html_nodes(kegg_map,'b') %>%
html_text('b')
map_class
v <- map_class
pattern <- paste0(v[-length(v)],v[-1])
pattern
pattern <- paste0(v[-length(v)],'.*',v[-1])
str_extract_all(a,pattern)
b <- str_extract_all(a,pattern)
b
length(b)
b[[1]]
pattern
class <- lapply(pattern,str_extract_all,string = a)
class
length(class)
class(1)
map_doc <- htmlParse(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
map_char <- as(map_doc, 'character')
map_class <- html_nodes(map_doc,'b') %>%
html_text('b')
pattern <- paste0(map_class[-length(map_class)],'.*',map_class[-1])
kegg_map <- lapply(pattern,str_extract_all,string = map_char)
kegg_map
length(kegg_map)
a <- kegg_map[[1]]
a
class(a)
a <- kegg_map[[1]] %>%
unlsit
a <- kegg_map[[1]] %>%
unlist
a
?str_replace_all
?str_extract_all
a
?str_replace_all
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
map_doc
length(map_doc)
paste0(map_doc)
?paste
grepl(map_doc, '^A')
?grepl
lapply(map_doc, grepl, pattern = '^A')
lapply(map_doc, grepl, pattern = '^A') %>%
unlist %>%
sum
class_no <- lapply(map_doc, grepl, pattern = '^A') %>%
unlist %>%
sum
class_no <- lapply(map_doc, grepl, pattern = '^A') %>%
unlist %>%
sum
class_no
?vector
class_map <- vector('list', class_no)
class_map
class_no <- lapply(map_doc, grepl, pattern = '^A') %>%
unlist %>%
which
class_no
class_name <- map_doc(class_index)
class_name <- map_doc[class_index]
class_index <- lapply(map_doc, grepl, pattern = '^A') %>%
unlist %>%
which
class_name <- map_doc[class_index]
class_name
?str_replace_all
class_name <- map_doc[class_index] %>%
lapply(pattern = '^A<b>(.*)</b>', replacement = "\\1")
class_name <- map_doc[class_index] %>%
lapply(str_replace_all,pattern = '^A<b>(.*)</b>', replacement = "\\1")
class_name
class_name <- map_doc[class_index] %>%
lapply(str_replace_all,pattern = '^A<b>(.*)</b>', replacement = "\\1") %>%
unlist
class_name
class_map <- vector('list', length(class_name))
class_map
class_index
class_length <- length(class_index)
class_map <- vector('list', class_length)
class_map
class_index[-1]
help(package='stringr')
?grepl
for ( i in length(map_doc)){
if (grepl('^A | ^C', map_doc[i]))
map_doc <- map_doc[-i]
}
map_doc
length(map_doc)
for ( i in 1:length(map_doc)){
if (grepl('^A | ^C', map_doc[i]))
map_doc <- map_doc[-i]
}
map_doc
grepl('^A | ^C', map_doc[1]
)
grepl('^A | ^C', map_doc[2]
for ( i in 1:length(map_doc)){
if (!grepl('^A | ^C', map_doc[i]))
map_doc <- map_doc[-i]
}
map_doc
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
?regex
for ( i in 1:length(map_doc)){
if (!grepl('^A & ^C', map_doc[i]))
map_doc <- map_doc[-i]
}
map_doc
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
map_doc
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
for ( i in 1:length(map_doc)){
if (!grepl('^A | ^C', map_doc[i]))
map_doc <- map_doc[-i]
}
map_doc
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
map_doc
grepl('^A | ^C', map_doc[i])
i
?grepl
lapply(map_doc,grepl(pattern = '^A | ^C'))
lapply(map_doc,grepl,pattern = '^A | ^C')
lapply(map_doc,grepl,pattern = '^A | ^C') %>%
which
lapply(map_doc,grepl,pattern = '^A | ^C') %>% unlist %>%
which
map_doc
lapply(map_doc,grepl,pattern = '^A | ^C') %>% unlist %>%
which
lapply(map_doc,grepl,pattern = '^A | ^C') %>% unlist
map_doc
lapply(map_doc,grepl,pattern = '^A|^C') %>%
unlist %>%
which
index <- lapply(map_doc,grepl,pattern = '^A|^C') %>%
unlist %>%
which
map_doc <- map_doc[index]
map_doc
class_index <- lapply(map_doc, grepl, pattern = '^A') %>%
unlist %>%
which
class_index
length(map_doc)
class_index
c(class_index[-1],length(map_doc))
map_doc[1:178]
c(class_index[-1],length(map_doc))
map_doc[483]
c(class_index[-1] - 1,length(map_doc))
1 178
mapply(class_index + 1, c(class_index[-1] - 1,length(map_doc)),
function(x,y){map_doc[x:y]}
mapply(class_index + 1, c(class_index[-1] - 1,length(map_doc)),
function(x,y){map_doc[x:y]})
?mapply
mapply(function(x,y){map_doc[x:y]}, class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
index <- lapply(map_doc,grepl,pattern = '^A|^C') %>%
unlist %>%
which
map_doc <- map_doc[index]
class_index <- lapply(map_doc, grepl, pattern = '^A') %>%
unlist %>%
which
class_name <- map_doc[class_index] %>%
lapply(str_replace_all,pattern = '^A<b>(.*)</b>', replacement = "\\1") %>%
unlist
map_class <- mapply(function(x,y){map_doc[x:y]}, class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_class
names(map_class) <- class_name
map_class
lapply(map_class,length)  %>% unlist %>% sum
read.table('http://rest.kegg.jp/list/pathway/hsa')
read.delim2('http://rest.kegg.jp/list/pathway/hsa', stringAsFactors = FALSE)
read.delim2('http://rest.kegg.jp/list/pathway/hsa', stringsAsFactors = FALSE)
map_class[[1]]
?str_extract_all
map_class <- mapply(function(x,y){map_doc[x:y] %>% lapply(str_extract_all,
pattern = '\\d+')} %>% strsplit, class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_class <- mapply(function(x,y){map_doc[x:y]} %>% strsplit, class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_class <- mapply(function(x,y){map_doc[x:y]}, class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_class
map_class <- mapply(function(x,y){map_doc[x:y]} %>% lapply(str_extract_all,
pattern = '\d+'), class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_class <- mapply(function(x,y){map_doc[x:y] %>% lapply(str_extract_all,
pattern = '\d+')}, class_index + 1,
map_class <- mapply(function(x,y){map_doc[x:y] %>% lapply(str_extract_all,
pattern = '\\d+')}, class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_class
map_class <- mapply(function(x,y){map_doc[x:y] %>% lapply(str_extract_all,
pattern = '\\d+') %>% unlist}, class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_class
map_class <- mapply(function(x,y){map_doc[x:y] %>% lapply(str_extract_all,
pattern = '\\d{5}') %>% unlist}, class_index + 1,
c(class_index[-1] - 1,length(map_doc)))
map_class
lapply(map_class,length) %>% unlist  %>% sum
names(map_class) <- class_name
map_class
human_pathway <- read.delim2('http://rest.kegg.jp/list/pathway/hsa',
stringsAsFactors = FALSE)
human_pathway
human_pathway[[1]]
human_pathway[[1]] <- str_extract_all(human_pathway,'\\d+')
human_pathway[[1]] <- lapply(human_pahtway,'\\d+') %>%
unlist
human_pathway[[1]] <- lapply(human_pahtway,str_extract_all',\\d+') %>%
unlist
human_pathway[[1]] <- lapply(human_pahtway,str_extract_all',\\d+') %>%
unlist
human_pathway[[1]] <- lapply(human_pahtway,str_extract_all,'\\d+') %>%
unlist
human_pathway[[1]] <- lapply(human_pathway,str_extract_all,'\\d+') %>%
unlist
human_pathway[[1]] <- lapply(human_pathway[[1]],str_extract_all,'\\d+') %>%
unlist
human_pathway
human_pathway[[1]]
match(human_pathway[[1]], map_class[[1]])
match(map_class[[1]], human_pathway[[1]])
match(map_class[[1]], human_pathway[[1]], nonmatch = 0)
?match
match(map_class[[1]], human_pathway[[1]], nomatch = 0)
?map
?match
lapply(map_class, match, table = human_pathway[[1]], nomatch = 0)
a <- lapply(map_class, match, table = human_pathway[[1]], nomatch = 0)
a
unlist(a)
which(unlist(a) > 0)
length(which(unlist(a) > 0))
a <- lapply(map_class[2:7], match, table = human_pathway[[1]], nomatch = 0)
length(which(unlist(a) > 0))
library(NFP)
getPathwayList
pathway_ID <- system.file('extdata/signalPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,header = FALSE,colClasses = 'character') %>%
extract2(1)
human_pathway <- system.file('extdata/humanPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,
header = FALSE,colClasses = 'character') %>%
extract2(1)
human_signalpathway <- intersect(pathway_ID,human_pathway)
human_signalpathway <- human_signalpathway[-125] ## ? bug
human_signalpathway
a <- lapply(map_class[1:7], match, table = human_pathway[[1]], nomatch = 0)
a
a
sss
library(RCurl)
library(XML)
library(rvest)
library(magrittr)
library(stringr)
## KEGG pathway
map_doc <- htmlParse(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
index <- lapply(map_doc,grepl,pattern = '^A|^C') %>%
unlist %>%
which
map_doc <- map_doc[index]
unlist %>%
class_name <- map_doc[class_index] %>%
unlist
pattern = '\\d{5}') %>% unlist}, class_index + 1,
names(map_class) <- class_name
lapply(str_replace_all,pattern = '^A<b>(.*)</b>', replacement = "\\1") %>%
c(class_index[-1] - 1,length(map_doc)))
which
map_class <- mapply(function(x,y){map_doc[x:y] %>% lapply(str_extract_all,
class_index <- lapply(map_doc, grepl, pattern = '^A') %>%
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
getPathwayList <- function(){
pathway_ID <- system.file('extdata/signalPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,header = FALSE,colClasses = 'character') %>%
extract2(1)
human_pathway <- system.file('extdata/humanPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,
header = FALSE,colClasses = 'character') %>%
extract2(1)
human_signalpathway <- intersect(pathway_ID,human_pathway)
human_signalpathway <- human_signalpathway[-125] ## ? bug
return(human_signalpathway)
}
library(magrittr)
library(plyr)
library(KEGGgraph)
library(igraph)
pathway <- getPathwayList()
pathway
loadKEGGRefNet <- function(){
human_signalpathway <- getPathwayList()
KEGG_graph <- human_signalpathway %>% laply(getKGMLurl,organism = 'hsa') %>%
llply(parseKGML2Graph,.progress = 'text') %>% llply(igraph.from.graphNEL)
names(KEGG_graph) <- human_signalpathway
return(KEGG_graph)
}
exportKEGGRefNet <- function() {
saveKEGGNet4Matlab <- function(pathway_id){
net <- pathway_id %>% getKGMLurl(organism = 'hsa') %>% parseKGML2Graph %>%
igraph.from.graphNEL
n  <- net %>% as_adj %>% as.matrix %>% row.names %>%
str_replace('hsa:','') %>% as.double
e <- net %>% as_adj %>% as.matrix
#writeMat(paste("hsa",pathway_id,".mat",sep=""), node=n, adj=e)
#write.csv(node,file=paste("hsa",pathway_id,".node",sep=""))
write.csv(e,paste("hsa",pathway_id,".adj",sep=""))
}
getPathwayList() %>% llply(saveKEGGNet4Matlab,.progress = 'text')
}
exportKEGGRefNet()
exportKEGGRefNet()
help(package='devtools')
library(devtools)
install.packages('devtools')
install.packages("devtools")
help(package = 'devtools')
install.packages('ISLR')
library(XML);
u1<-"http://money.finance.sina.com.cn/corp/go.php/vFD_FinancialGuideLine/stockid/000002/ctrl/2010/displaytype/4.phtml";
df2<-readHTMLTable(u1,header = FALSE,stringsAsFactors=FALSE)[[20]];
df2<-readHTMLTable(u1,header = FALSE,stringsAsFactors=FALSE)[[20]];
df2
help(package='NFP')
library(devtools)
install_github('yiluheihei/NFP')
load_all()
install()
?install
getwd()
ls
load_all()
document
document()
install()
install(dependencies = FALSE)
ls()
rm(list=ls())
ls
ls()
help(package='mmnet')
pathway_ID <- system.file('extdata/signalPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,header = FALSE,colClasses = 'character') %>%
extract2(1)
human_pathway <- system.file('extdata/humanPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,
header = FALSE,colClasses = 'character') %>%
extract2(1)
human_signalpathway <- intersect(pathway_ID,human_pathway)
human_signalpathway <- human_signalpathway[-125] ## ? bug
library(magrittr)
pathway_ID <- system.file('extdata/signalPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,header = FALSE,colClasses = 'character') %>%
extract2(1)
human_pathway <- system.file('extdata/humanPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,
header = FALSE,colClasses = 'character') %>%
extract2(1)
human_signalpathway <- intersect(pathway_ID,human_pathway)
human_signalpathway <- human_signalpathway[-125] ## ? bug
human_signalpathway
length(human_signalpathway)
human_pathway[1,]
map_doc <- readLines(paste0('http://www.kegg.jp/kegg-bin/',
'download_htext?htext=br08901.keg&format=htext&filedir='))
pathway_ID <- system.file('extdata/signalPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,header = FALSE,colClasses = 'character') %>%
extract2(1)
human_pathway <- system.file('extdata/humanPathway.txt',package='NFP') %>%
read.delim(stringsAsFactors = FALSE,
header = FALSE,colClasses = 'character') %>%
extract2(1)
human_signalpathway <- intersect(pathway_ID,human_pathway)
human_signalpathway
human_signalpathway[125]
